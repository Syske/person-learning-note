## Pythonæ“ä½œExcel

### ç¼˜ç”±

æ•…äº‹è¦ä»ä¸€ä¸ªç»Ÿè®¡è¡¨æ ¼è¯´èµ·ğŸ˜‚ï¼Œæˆ‘æ‰‹é‡Œæœ‰ä¸ªé¡¹ç›®ï¼Œæ¯ä¸ªæœˆ28å·éœ€è¦æä¾›å„ä¸ªæ¥å£çš„è®¿é—®æ¬¡æ•°çš„ç»Ÿè®¡æ•°æ®ï¼Œä¹‹å‰éƒ½æ˜¯é€šè¿‡`sql`ç»Ÿè®¡æŸ¥è¯¢ï¼Œç„¶åæ±‡æ€»æˆ`excel`ã€‚å› ä¸ºæˆ‘æ¯”è¾ƒæ‡’ï¼Œè€æƒ³èµ°æ·å¾„ï¼Œå–œæ¬¢æŠ˜è…¾ï¼ŒåŒæ—¶ä¹Ÿæƒ³ç€èƒ½ä¸èƒ½é€šè¿‡`python`åšç‚¹å•¥ï¼Œæ­£å¥½è¿™ä¸ªå‡æœŸåˆä»å¤´å­¦äº†ä¸€æ¬¡`python`ï¼Œæ‰€ä»¥å°±æƒ³å®è·µä¸‹ã€‚

æˆ‘å…ˆæŸ¥äº†`python`ä½¿ç”¨`Oracle`æ•°æ®åº“çš„èµ„æ–™ï¼Œå‘ç°å¾ˆç®€å•ï¼Œç„¶åå¼€å§‹å°è¯•é…ç½®ç¯å¢ƒï¼Œå®‰è£…åº“æ–‡ä»¶ï¼ŒæŠ˜è…¾äº†å¥½ä¹…ï¼Œç»ˆäºä¸€åˆ‡éƒ½é¡ºåˆ©äº†ï¼Œç„¶ååˆå»æŸ¥äº†æ‰§è¡Œ`sql`ã€è·å–ç»“æœé›†ï¼Œä¸€åˆ‡éƒ½æ˜¯å¾ˆé¡ºå…¶è‡ªç„¶çš„å‘ç”Ÿã€‚ç„¶åæˆ‘åˆæœ‰äº†æ–°çš„æƒ³æ³•ï¼Œæˆ‘åœ¨åºŠä¸ŠæŸ¥è¯¢äº†`python`æ“ä½œ`Excel`çš„ç›¸å…³èµ„æ–™ï¼Œç´§æ¥ç€ä»Šå¤©èµ·åºŠåå¼€å§‹å®è·µã€å®éªŒã€æŸ¥èµ„æ–™ï¼Œæœ€åå®Œç¾è¾¾åˆ°ç»“æœï¼Œå½“ç„¶æœ€å¤§çš„å®ˆæŠ¤æ˜¯å¯¹`python`æœ‰äº†æ–°çš„è®¤çŸ¥å’Œç†è§£ï¼Œæˆ‘èƒ½æ·±åˆ‡ä½“ä¼šåˆ°å¥¹ä¼šåœ¨ä»¥åçš„å·¥ä½œå’Œç”Ÿæ´»ä¸­ï¼Œæˆä¸ºæˆ‘çš„æœ‰ä¸€ä¸ªæ–°çš„å¾—åŠ›åŠ©æ‰‹ï¼Œè®©æˆ‘å‰è¿›ï¼Œè¿™ç®€ç›´å®Œç¾ï¼Œä¹Ÿè®©äººè§‰å¾—å†…å¿ƒæ„‰æ‚¦ã€‚

ä¸ºå•¥å­¦`python`è€æ˜¯æ²¡åšæŒå­¦å®Œï¼Œæ²¡æœ‰ä»€ä¹ˆç»“æœï¼Œä¸»è¦æ˜¯æ²¡ææ¸…æ¥šï¼Œæ²¡ç”¨æ˜ç™½ï¼Œå½“ç„¶ä¹Ÿæ˜¯å› ä¸ºæ²¡æœ‰çœŸæ­£å®è·µå»åšé¡¹ç›®ï¼Œç»å¸¸ç»ƒçš„éƒ½æ˜¯ä¸€äº›åŸºæœ¬çš„ç®€å•æ“ä½œã€‚ä»Šå¤©ä¹‹å‰ï¼Œå‡†ç¡®çš„è¯´åº”è¯¥æ˜¯æè¿™ä¸ªé¡¹ç›®ä¹‹å‰ï¼Œæˆ‘å¯¹`python`éƒ½æ˜¯ç”±åè§çš„ï¼Œæœ€ä¸å–œæ¬¢çš„å°±æ˜¯ä»–çš„ç¼©è¿›ï¼Œä½†æ˜¯é€šè¿‡æ­¤æ¬¡é¡¹ç›®ï¼Œæˆ‘æ˜æ˜¾æ„Ÿè§‰åˆ°è‡ªå·±å¯¹`python`æœ‰äº†æ–°çš„è®¤çŸ¥å’Œè§è§£ï¼Œå¿½ç„¶è§‰å¾—è±ç„¶å¼€æœ—äº†ï¼Œè¿™ç§æ„Ÿè§‰å¾ˆç¥å¥‡ï¼Œå°±åƒé¡¿æ‚Ÿä¸€æ ·ã€‚å’Œå½“æ—¶å­¦javaçš„æ—¶å€™å¾ˆåƒï¼Œå‰å‰ååè‡ªå­¦äº†å¾ˆå¤šï¼Œä½†ä¸€ç›´æ˜¯ä»è‡ªå­¦åˆ°æ”¾å¼ƒï¼Œä¸€ç›´åœ¨é—¨å¤–å¾˜å¾Šï¼Œç›´è¾¾åæ¥ï¼Œæˆ‘è¯•ç€å»å¤šå†™ï¼Œå¤šå®éªŒï¼Œå¤šç¢ç£¨ï¼Œå°½å¯èƒ½æŠŠè¯¾åçš„ä»£ç ç¤ºä¾‹éƒ½æ•²ä¸€éï¼Œæ—¶é—´ä¹…äº†ï¼Œå¿½ç„¶æœ‰ä¸€å¤©å°±å’Œä»Šå¤©çš„æ„Ÿè§‰ä¸€æ ·ï¼Œæˆ‘è§‰å¾—è‡ªå·±å…¥é—¨äº†ã€‚

æˆ‘å¯¹å…¥é—¨çš„å®šä¹‰æ˜¯ä¼šç”¨ï¼Œèƒ½å¤Ÿç”¨ä¸€ç§è¯­è¨€æ¥å®Œæˆä¸€äº›å·¥ä½œï¼Œåšä¸€äº›å°ä¸œè¥¿ï¼Œä»Šå¤©æˆ‘å°±æ˜¯åšåˆ°äº†ï¼Œä»æœ‰æƒ³æ³•ï¼Œåˆ°æœç´¢èµ„æ–™ï¼Œåˆ°å®éªŒï¼Œé€šè¿‡ä¸æ–­åœ°å°è¯•å’ŒæŸ¥è¯¢èµ„æ–™ï¼Œæˆ‘åšåˆ°äº†ï¼Œæˆ‘ä¹Ÿæ”¶è·äº†ã€‚

### å‡†å¤‡å·¥ä½œ

#### å®‰è£…openpyxl

##### pipå®‰è£…

```sh
pip install openpyxl
```

##### ç¦»çº¿å®‰è£…

ä¸‹è½½ç½‘å€ï¼š

```
https://www.lfd.uci.edu/~gohlke/pythonlibs/
```

ä¸‹è½½å¦‚ä¸‹æ–‡ä»¶ï¼š

```
et_xmlfile-1.0.1-py2.py3-none-any.whl
jdcal-1.4-py2.py3-none-any.whl
openpyxl-2.6.0-py2.py3-none-any.whl
```

å°†ä¸Šè¿°ä¸‰ä¸ªæ–‡ä»¶æ‹·è´åˆ°`python`å®‰è£…ç›®å½•ä¸­çš„`scripts`æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶é€šè¿‡ä¸€ä¸‹æ–¹å¼å®‰è£…ï¼š

```
pip install æ–‡ä»¶å
```

å®Œæˆä»¥ä¸Šå·¥ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹å†™è„šæœ¬äº†

### 

### å¼•å…¥åŒ…èµ„æº

```python
from openpyxl import Workbook
æˆ–è€…
import openpyxl
```

ä¸¤ç§æ–¹å¼çš„åŒºåˆ«å°±æ˜¯ï¼Œä¸‹é¢çš„è¿™ç§æ–¹å¼éœ€è¦åœ¨è°ƒç”¨æ–¹æ³•çš„æ—¶å€™åŠ ä¸Š`openpyxl.`ï¼Œåé¢è¿˜ä¼šæåˆ°

### åˆ›å»ºå·¥ä½œè¡¨

å¦‚æœæ˜¯ç¬¬ä¸€ç§å¼•åŒ…çš„æ–¹å¼ï¼Œå†™æ³•æ˜¯è¿™æ ·çš„ï¼š

```python
# åˆ›å»ºä¸€ä¸ªWorkbookå¯¹è±¡
wb = Workbook()
```

å¦‚æœæ˜¯ç¬¬äºŒç§åˆ™æ˜¯è¿™æ ·çš„ï¼š

```python
wb = openpyxl.Workbook()
```

åé¢å°±ä¸å†è¯´æ˜äº†ï¼Œé»˜è®¤ç”¨ç¬¬ä¸€ç§æ–¹å¼

### æ“ä½œsheet

#### åˆ›å»ºsheet

```python
# åˆ›å»ºä¸€ä¸ªSheetå¯¹è±¡
ws1 = wb.create_sheet(index=0, title="Mysheet")
æˆ–è€…
ws2 = wb.create_sheet("Mysheet", 0) 
æˆ–è€…
ws3 = wb.create_sheet("Mysheet")  
```

- `index`æŒ‡çš„æ˜¯`sheet`çš„ä½ç½®ï¼Œ0è¡¨ç¤ºç¬¬ä¸€ä¸ªï¼Œå¦‚æœçœç•¥çš„è¯ï¼Œé»˜è®¤æ˜¯åœ¨å·²æœ‰çš„`sheet`åé¢è¿›è¡Œè¿½åŠ 
- `title`å°±æ˜¯`sheet`çš„åå­—

**æ³¨æ„ï¼š**éœ€è¦æ³¨æ„çš„æ˜¯`sheet`çš„åå­—å¦‚æœæ˜¯ä¸­æ–‡çš„è¯ï¼Œå¿…é¡»æ˜¯`Unicode`ç¼–ç 

```python
ws2.title = (u"ä½ å¥½")    #è®¾å®šä¸€ä¸ªsheetçš„åå­— å¿…é¡»æ˜¯Unicode
```

#### è·å–sheet

##### è·å–æ´»åŠ¨çš„sheet

```python
# è·å–æ´»åŠ¨çš„sheet
activeSheet = wb.active
```

##### æ ¹æ®åå­—è·å–sheet

```python
#è·å–æŸä¸ªsheetå¯¹è±¡
print (wb.get_sheet_by_name(u"ä½ å¥½"  ))
```

##### è·å–æ‰€æœ‰sheet

```python
#è·å–å…¨éƒ¨sheet çš„åå­—ï¼Œéå†sheetåå­—
print (wb.sheetnames)
for sheet_name in wb.sheetnames:
    print (sheet_name)
# éå†wbä¸­çš„sheet
for sheet in wb:
    print (sheet.title)
```

##### ç¼–è¾‘sheetæ ‡ç­¾èƒŒæ™¯é¢œè‰²

```python
# è®¾ç½®æ´»åŠ¨è¡¨é¢œè‰²
activeSheet.sheet_properties.tabColor = "205EB2"
#è®¾å®šsheetçš„æ ‡ç­¾çš„èƒŒæ™¯é¢œè‰²
ws1.sheet_properties.tabColor = "1072BA"   
```

#### å¤åˆ¶sheet

```python
#å¤åˆ¶ä¸€ä¸ªsheet
wb["New Title" ]["A1"]="zeke"
source = wb["New Title" ]
target = wb.copy_worksheet(source)
```

#### å•å…ƒæ ¼æ“ä½œ

##### è¯»å–æ•°æ®

```python
print(mySheet['B4'].value)
```

##### èµ‹å€¼

ä¸‹é¢è¿™å‡ ç§æ“ä½œæ–¹å¼ï¼Œæœ¬è´¨ä¸Šä¸€æ ·

```python
mySheet['B4'].value = 'hello world'
æˆ–è€…
wb["New Title" ]["A1"]="zeke"
æˆ–è€…
tableNameCell = activeSheet.cell(row = 1, column = 1, value = 'hello')
```

##### å•å…ƒæ ¼åˆå¹¶

```python
mySheet.merge_cells('a1:d1')
```

ä¸Šé¢çš„æ“ä½œå°±æ˜¯åˆå¹¶`a1`åˆ°`d1`ä¹‹é—´çš„å•å…ƒæ ¼

##### è®¾ç½®è¡Œé«˜

```python
mySheet.row_dimensions[1].height = 55
```

##### è®¾ç½®åˆ—å®½

```python
# è®¾ç½®åˆ—å®½åº¦
mySheet.column_dimensions['A'].width = 36
```

##### å•å…ƒæ ¼æ±‚å’Œ

```python
sum = 0
for cellssss in mySheet['B4:B20']:
    for cell in cellssss:
        co = cell.value
        if not co is None:
            sum = sum + cell.value
print("æ±‚å’Œç»“æœï¼š", sum)
```

è¿™é‡Œæˆ‘å†™äº†ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå•å…ƒæ ¼æ±‚å’Œï¼š

```python
# æ±‚å’Œ    
# cells å–å€¼ä¸ºsheetçš„åˆ‡ç‰‡ï¼Œå¦‚ï¼šmySheet['B4:B20']
def sum(cells):    
    sum = 0
    for cellssss in cells:
        for cell in cellssss:
            co = cell.value
            if not co is None:
                sum = sum + cell.value
    print("æ±‚å’Œç»“æœï¼š", sum)
    return sum
```

##### æ‰¹é‡æ“ä½œå•å…ƒæ ¼

æ¯”å¦‚æ“ä½œ`A3-D3`,`A7-D7`,`A14-D14`,`A18-D18`è¿™äº›åŒºåŸŸçš„å•å…ƒæ ¼ï¼Œæˆ‘çš„è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š

```python
# èƒŒæ™¯å¡«å……
for i in [3, 7, 10, 14, 18]:
    for cells in mySheet['A'+ str(i) +':D' + str(i)]:
        for cell in cells:
            cell.fill = fill
```

å¦‚æœæ˜¯æ“ä½œæŸä¸€èŒƒå›´å†…çš„å•å…ƒæ ¼ï¼Œè¿™æ ·è¿™æ ·æ“ä½œï¼Œå…¶å®ä¸Šé¢æ±‚å’Œå°±æ˜¯è¿™ä¹ˆæ“ä½œçš„ï¼š

```python
for cells in mySheet['D3:D21']:
    for cell in cells:
        valueC = mySheet['C' + str(cell.row)].value
        valueB = mySheet['B' + str(cell.row)].value
# æˆ–è€…è¿™æ ·
# è·å–å•å…ƒæ ¼åˆ‡ç‰‡
cellsA = mySheet['B3:D21']
# è®¾ç½®è¡¨æ ¼æ ·å¼
for cellssss in cellsA:
    for cell in cellssss:
        cell.style = dataCellStyle
```

ä¸Šé¢çš„æ“ä½œå…¶å®å¤§åŒå°å¼‚ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¸€æ ·ã€‚éœ€è¦æåˆ°çš„æ˜¯

- `cell.row`è·å–åˆ°çš„æ˜¯å•å…ƒæ ¼çš„è¡Œå·ï¼Œæ¯”å¦‚`A20`ï¼Œè·å–åˆ°çš„æ˜¯`20`
- `cell.column_letter`è·å–åˆ°çš„æ˜¯å•å…ƒæ ¼çš„åˆ—ï¼Œå³å­—æ¯ï¼Œæ¯”å¦‚`B20`è·å–åˆ°çš„æ˜¯`B`
- `cell.col_idex`è·å–åˆ°çš„æ˜¯å½“å‰å•å…ƒæ ¼åˆ—å­—æ¯å¯¹åº”çš„åºå·ï¼Œæ¯”å¦‚`A2`å¯¹åº”çš„æ˜¯`1`ï¼Œ`E3`å¯¹åº”çš„æ˜¯`5`,`Z4`å¯¹åº”çš„æ˜¯`26`,`AA4`å¯¹åº”çš„æ˜¯`27`ï¼Œä»¥æ­¤ç±»æ¨

#### å•å…ƒæ ¼æ ·å¼æ“ä½œ

è¿™é‡Œçš„å†…å®¹å°±æ¯”è¾ƒå¤šäº†ï¼Œå› ä¸ºsheetä¸­è¡¨æ ¼çš„æ ·å¼æ¯”è¾ƒå¤šï¼Œæ¶‰åŠåˆ°å•å…ƒæ ¼åˆå¹¶ã€èƒŒæ™¯è®¾ç½®ã€å­—ä½“è®¾ç½®ã€è¾¹æ¡†è®¾ç½®ã€å°ºå¯¸è®¾ç½®ç­‰ï¼Œæ‰€ä»¥å†…å®¹ä¹Ÿä¼šæ¯”è¾ƒå¤šã€‚

##### å¼•å…¥åŒ…

```python
from openpyxl.styles import colors
from openpyxl.styles import NamedStyle,Alignment,Side,Border,Font,Color,PatternFill
```

å…¶ä¸­ï¼Œ`NamedStyle`æ˜¯å…¶ä»–æ‰€æœ‰æ ·å¼çš„è½½ä½“ï¼›`Alignment`æ˜¯æ–‡æœ¬å¯¹é½æ ·å¼ï¼ˆå‚ç›´/æ°´å¹³ï¼‰ï¼›`Side`æ˜¯è¾¹æ¡†æ ·å¼ï¼Œçº¿æ¡å®½åº¦ï¼Œé¢œè‰²ï¼Œçº¿æ¡è™šå®ç­‰ï¼›`Border`æ˜¯å•å…ƒæ ¼è¾¹æ¡†æ ·å¼ï¼Œä¸Šã€ä¸‹ã€å·¦ã€å³ç­‰ï¼›`Font`æ˜¯å­—ä½“æ ·å¼ï¼ŒåŒ…æ‹¬å­—ä½“ã€å¤§å°ã€é¢œè‰²ç­‰ï¼›`PatternFill`æ˜¯å¡«å……æ ·å¼ï¼ŒåŒ…æ‹¬å¡«å……é¢œè‰²ã€å¡«å……æ ·å¼ç­‰

##### åˆ›å»ºæ ·å¼

æŒ‡å®šæ ·å¼åç§°ï¼Œåˆ›å»ºæ ·å¼

```python
classopenpyxl.styles.named_styles.NamedStyle(name='Normal', font=<openpyxl.styles.fonts.Font object> Parameters: name=None, charset=None, family=None, b=False, i=False, strike=None, outline=None, shadow=None, condense=None, color=None, extend=None, sz=None, u=None, vertAlign=None, scheme=None, fill=<openpyxl.styles.fills.PatternFill object> Parameters: patternType=None, fgColor=<openpyxl.styles.colors.Color object> Parameters: rgb='00000000', indexed=None, auto=None, theme=None, tint=0.0, type='rgb', bgColor=<openpyxl.styles.colors.Color object> Parameters: rgb='00000000', indexed=None, auto=None, theme=None, tint=0.0, type='rgb', border=<openpyxl.styles.borders.Border object> Parameters: outline=True, diagonalUp=False, diagonalDown=False, start=None, end=None, left=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, right=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, top=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, bottom=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, diagonal=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, vertical=None, horizontal=None, alignment=<openpyxl.styles.alignment.Alignment object> Parameters: horizontal=None, vertical=None, textRotation=0, wrapText=None, shrinkToFit=None, indent=0.0, relativeIndent=0.0, justifyLastLine=None, readingOrder=0.0, number_format=None, protection=<openpyxl.styles.protection.Protection object> Parameters: locked=True, hidden=False, builtinId=None, hidden=False, xfId=None)
```

ç¤ºä¾‹ï¼š

```python
headerCellStyle = NamedStyle(name = 'headerCellStyle')
```

##### åˆ›å»ºæ–‡æœ¬å¯¹é½æ ·å¼

```python
classopenpyxl.styles.alignment.Alignment(horizontal=None, vertical=None, textRotation=0, wrapText=None, shrinkToFit=None, indent=0, relativeIndent=0, justifyLastLine=None, readingOrder=0, text_rotation=None, wrap_text=None, shrink_to_fit=None, mergeCell=None)
```

ç¤ºä¾‹ï¼š

```python
# æ°´å¹³å‚ç›´å±…ä¸­
headerCellStyle.alignment = Alignment(horizontal = 'center', vertical = 'center') 
```

`horizontal`è¡¨ç¤ºæ°´å¹³å¯¹é½æ–¹å¼ï¼Œ`vertical`è¡¨ç¤ºå‚ç›´å¯¹é½æ–¹å¼ï¼Œå–å€¼æœ‰`center`ã€`left`ã€`right`

##### åˆ›å»ºçº¿æ¡†æ ·å¼

è¿™ä¸ªæ ·å¼æ˜¯ç»™å•å…ƒæ ¼æ ·å¼å‡†å¤‡çš„ï¼Œä¸æ˜¯ç›´æ¥èµ‹ç»™`headerCellStyle`çš„ï¼Œå®ƒçš„å½’å±å…³ç³»æ˜¯ï¼š`openpyxl.styles.borders.Side`

```python
classopenpyxl.styles.borders.Side(style=None, color=None, border_style=None)
```

ç¤ºä¾‹ï¼š

```python
# çº¿æ¡†æ ·å¼
border = Side(border_style = 'thin', color = '000000') 
```

`border_style`å–å€¼èŒƒå›´å¦‚ä¸‹ï¼š

```python
'slantDashDot', 
'medium', 
'hair', 
'mediumDashDotDot', 
'dashed', 
'dotted', 
'thick', 
'double', 
'dashDotDot', 
'thin', 
'mediumDashDot', 
'mediumDashed', 
'dashDot'
```

`color`å–å€¼æ˜¯åå…­è¿›åˆ¶é¢œè‰²

##### åˆ›å»ºå•å…ƒæ ¼è¾¹æ¡†æ ·å¼

è®¾ç½®å•å…ƒæ ¼ä¸Šä¸‹å·¦å³çš„è¾¹æ¡†æ ·å¼ï¼ŒåŒ…ä¿¡æ¯ï¼š`openpyxl.styles.borders.Border`

```python
classopenpyxl.styles.borders.Border(left=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, right=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, top=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, bottom=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, diagonal=<openpyxl.styles.borders.Side object> Parameters: style=None, color=None, diagonal_direction=None, vertical=None, horizontal=None, diagonalUp=False, diagonalDown=False, outline=True, start=None, end=None)
```

ç¤ºä¾‹ï¼š

```python
# è®¾ç½®å•å…ƒæ ¼è¾¹æ¡†æ ·å¼
headerCellStyle.border = Border(left = border, top = border, right = border, bottom = border) 
```

`left`,`right`,`top`,`bottom`çš„å–å€¼ï¼Œæ¥æºäºæˆ‘ä»¬å‰é¢å®šä¹‰çš„çº¿æ¡†æ ·å¼ï¼ˆ`Side`ï¼‰

##### åˆ›å»ºå­—ä½“æ ·å¼

```python
classopenpyxl.styles.fonts.Font(name=None, sz=None, b=None, i=None, charset=None, u=None, strike=None, color=None, scheme=None, family=None, size=None, bold=None, italic=None, strikethrough=None, underline=None, vertAlign=None, outline=None, shadow=None, condense=None, extend=None)
```

ç¤ºä¾‹ï¼š

```python
# å¤§æ ‡é¢˜å­—ä½“
    nameFont = Font(
    name = 'ç­‰çº¿',
    size = 16,
    bold = True,
    italic = False,
    vertAlign = None,
    underline = 'none',
    strike = False
    )
```

å­—ä½“çš„ç›¸å…³å±æ€§éƒ½å¾ˆç®€å•ï¼Œ`vertAlign`æ˜¯æ°´å¹³å¯¹é½ï¼Œ`strike`è¡¨ç¤ºåˆ é™¤çº¿

##### åˆ›å»ºå¡«å……æ ·å¼

```python
classopenpyxl.styles.fills.PatternFill(patternType=None, fgColor=<openpyxl.styles.colors.Color object> Parameters: rgb='00000000', indexed=None, auto=None, theme=None, tint=0.0, type='rgb', bgColor=<openpyxl.styles.colors.Color object> Parameters: rgb='00000000', indexed=None, auto=None, theme=None, tint=0.0, type='rgb', fill_type=None, start_color=None, end_color=None)
```

ç¤ºä¾‹ï¼š

```python
fill = PatternFill("solid", fgColor="E2EFDA")
```

**æ³¨æ„ï¼š**ä»¥ä¸Šæ ·å¼éƒ½å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼ç›´æ¥èµ‹å€¼ç»™å•å…ƒæ ¼ï¼Œæ¯”å¦‚ï¼š

```
cell.fill = fill
cell.font = normalfont
```

å¦‚æœæ˜¯å•ä¸ªæ ·å¼ï¼Œé€šè¿‡å¦‚ä¸Šæ–¹å¼ç›´æ¥èµ‹å€¼ç»™å•å…ƒæ ¼å³å¯ï¼Œå¦‚æœæ ·å¼æ¯”è¾ƒå¤šï¼Œæˆ‘ä¸ªäººè§‰æ˜¯é€šè¿‡åˆ›å»º`NamedStyle`çš„æ–¹å¼æ¯”è¾ƒåˆç†ã€‚

```python
tableNameCell.style = tableNameStyle
```

å…¶ä»–æ ·å¼ç›®å‰æ²¡æœ‰ç”¨åˆ°ï¼Œè¿™é‡Œä¸ä»‹ç»äº†ï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´å¯ä»¥å»çœ‹æ–‡æ¡£ï¼šhttp://yumos.gitee.io/openpyxl3.0/index.html#document-styles

è¿™é‡Œæ”¾ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„æ ·å¼ï¼š

```python
    # å­—ä½“æ ·å¼
    normalfont = Font(name = 'ç­‰çº¿',
    size = 11,
    italic = False,
    vertAlign = None,
    underline = 'none',
    strike = False
    )
    # å¡«å……æ ·å¼
    fill = PatternFill("solid", fgColor="E2EFDA")

    # åˆ›å»ºå•å…ƒæ ¼æ ·å¼å¯¹è±¡
    headerCellStyle = NamedStyle(name = 'headerCellStyle')
    # æ°´å¹³å‚ç›´å±…ä¸­
    headerCellStyle.alignment = Alignment(horizontal = 'center', vertical = 'center')  
    # çº¿æ¡†æ ·å¼
    border = Side(border_style = 'thin', color = '000000') 
    # è®¾ç½®å•å…ƒæ ¼è¾¹æ¡†æ ·å¼
    headerCellStyle.border = Border(left = border, top = border, right = border, bottom = border) 
    headerCellStyle.font = normalfont
    # å¡«å……æ ·å¼
    titleStyle.fill = fill
```

#### ä¿å­˜æ•°æ®

```python
# ä¿å­˜æ•°æ®
wb.save("python-first-excel.xlsx")
# å…³é—­å·¥ä½œè¡¨
wb.close()
```

å¥½äº†ï¼Œæœ¬æ¬¡æ¢è®¨åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¦‚æœä½ èƒ½æŒæ¡ä»¥ä¸Šå†…å®¹ï¼Œä½ å·²ç»å¯ä»¥å¯ä»¥é€šè¿‡pythonåˆ›å»ºä¸€ä¸ªexcelæ–‡ä»¶ï¼Œç„¶åå¡«å……ä½ çš„æ•°æ®ï¼Œç¾åŒ–è°ƒæ•´å•å…ƒæ ¼çš„æ ·å¼ã€‚å¦‚æœä½ é…åˆæˆ‘å‰ä¸€ç¯‡åšå®¢ï¼Œå·²ç»å·²ç»å¯ä»¥ç”Ÿæˆç®€å•çš„`excel`æŠ¥è¡¨äº†ï¼Œå½“ç„¶ï¼Œè¿™é‡Œåªæ˜¯ç®€å•æ¼”ç¤ºäº†`openpyxl`æ“ä½œå•å…ƒæ ¼çš„åŸºæœ¬æ–¹æ³•ï¼Œå…¶å®è¿˜æœ‰å¾ˆå¤šå¼ºå¤§çš„åŠŸèƒ½æ²¡æœ‰å±•ç¤ºï¼Œæ¯”å¦‚`excel`çš„å„ç§å›¾è¡¨çš„ç»˜åˆ¶ç­‰ï¼Œä¸€æ–¹é¢æ˜¯ç”±äºç¯‡å¹…çš„åŸå› ï¼Œå¦å¤–ä¸€æ–¹é¢æˆ‘è¿˜æ²¡æƒ³å¥½ï¼Œä½†ä¸»è¦è¿˜æ˜¯å› ä¸ºæˆ‘è¿˜æ²¡å­¦ğŸ˜‚